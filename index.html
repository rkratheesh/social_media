<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">        
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
h4{
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-size: 18px;
    font-weight: bolder;
    font-style: normal;
    text-align: end;

}
h5 {
  font-family: Arial, Helvetica, sans-serif;
  font-size: 18px;
    font-weight: 800;
    
    font-style: normal;
    text-align:justify ; 
}p {
  font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
  font-size: 18px;
    font-weight: normal;
    font-style: normal;
    text-align:justify ; 
}
  </style>
      </head>
    <body class="" style="background-color: rgb(145, 147, 177);">

        <div class="container" id="main_container">
            <!-- nav bar-->
            <nav class="navbar navbar-light bg-light mt-3 mb-5 rounded-pill ">
                <a class="navbar-brand mx-3"  data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                    <i class="fa-solid fa-user"></i>
                </a>
                  <div class="w-75"></div>
                  <h4 id="username" class=""></h4>
                <!-- Button trigger modal -->
                <button type="" class="" id="user_form" data-bs-toggle="modal" data-bs-target="#login" hidden>
                    create account
                </button> 
                <button type="button" class="btn mx-1" id="user_logout" >
                  <i class="fa-solid fa-right-from-bracket"></i>
                </button>
              
            </nav>
            <!-- profile card -->
           
        <div class="card mx-3 collapse position-absolute" id="collapseExample" style="width: 18rem; ">
            <img class="card-img-top" src="https://i.pinimg.com/originals/37/67/ff/3767ff64aeacddd756f71ae79cfb70b0.jpg" alt="Card image cap">
            <div class="card-body">
              <h5 class="card-title" id="profile_name"></h5>
              <p class="card-text" id="bio"></p>
              <a href="#" class="btn btn-primary"  data-bs-toggle="modal" data-bs-target="#profile">Update</a>
            </div>
          </div>


          <!-- post  -->
          <div class="row justify-content-center" id="post">
            <div class="col-4" >
              <div class="form-group d-flex justify-content-between">
                <input type="text" id="post_input" class="form-control">
                <button class="btn btn-primary mx-1" id="post_btn">Post</button>
              </div>
            </div>
          </div>
     
            
            <div class="row justify-content-center mt-3 " id="post">
              <h1 class="d-flex justify-content-center mx-4">Post</h1>
              
              <div class="all-post col-6 ">
              
          
              </div>
            </div>
          </div>
        
  <!-- login form -->
  <div class="modal fade" id="login" tabindex="-1" aria-labelledby="exampleModalLabel" id="login-modal" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Login</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
        <label for="">Username</label>
        <input id="login_username" type="text" class="form-control">  
        <label for="">Password</label>
        <input id='login_password' type="text" class="form-control"> 
        </div>
        <div class="modal-footer">
          <button type="" class="btn"  data-bs-toggle="modal" data-bs-target="#register" >
            create account
        </button> 
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button id="login_form" type="button" class="btn btn-primary" >Save changes</button>
        </div>
      </div>
    </div>
  </div>




  <!-- registration form -->
<div class="modal fade" id="register" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Register</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
        <label for="">Username</label>
        <input type="text" id="register_name" class="form-control">  
        <label for="">Password</label>
        <input type="text" id="register_password" class="form-control"> 
        </div>
        <div class="modal-footer">
            <a href=""></a>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button id="register_form" type="button" class="btn btn-primary" data-bs-dismiss="modal" >Save changes</button>
        </div>
      </div>
    </div>
  </div>


  
<!-- Profile add and update-->
<div class="modal fade" id="profile" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Profile update</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
        <label for="">Name</label>
        <input type="text" id="profile_name_input" class="form-control">  
        <label for="">Bio</label>
        <textarea type="text" id="profile_bio" class="form-control"> </textarea>
        <input type="file" name="" id="profile-img" class="form-control">
        </div>
        <div class="modal-footer">
            <a href=""></a>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button id="update_profile" type="button" class="btn btn-primary" data-bs-dismiss="modal" >Save changes</button>
        </div>
      </div>
    </div>
  </div>
  
<!-- post delete and update-->
<div class="modal fade" id="post_update" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Post update</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
        <label for="">Post</label>
        <textarea type="text" id="post_update_value" class="form-control">  
        </textarea>
        <div class="modal-footer">
            <a href=""></a>
          <button type="button" class="btn btn-secondary" id="delete-post" data-bs-dismiss="modal">Delete</button>
          <button id="update-post" type="button" class="btn btn-primary" data-bs-dismiss="modal" >Save changes</button>
        </div>
      </div>
    </div>
  </div>
  
        <script src="https://code.jquery.com/jquery-3.6.3.js" integrity="sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM=" crossorigin="anonymous"></script>
        <script>

          // main div hide
          $('#main_container').hide()
         
                // user registration 
                $('#btn-register').on('click',function(){
                  $('#user_form').click()
                  })
               
                console.log(localStorage)
                $('#register_form').on('click',function(){
                   var register_name =  $('#register_name').val()
                   var register_password =  $('#register_password').val()
                   if (localStorage.hasOwnProperty(register_name) && localStorage.hasOwnProperty(register_password)){
                     alert('Username or password already exit')
                   }else{
                    localStorage.setItem(register_name,register_name)
                    localStorage.setItem(register_password,register_password)
                    }
                })

                // user login
                var login_username
                $('#login_form').on('click',function(){
            
       
          
                    login_username = $('#login_username').val()
                    var login_password = $('#login_password').val()
                    console.log(localStorage.getItem('password'))
                    if (localStorage.hasOwnProperty(login_username) && localStorage.hasOwnProperty(login_password)){
                      sessionStorage.setItem('loggedIn',true)
                      localStorage.setItem('user',login_username)
                      
                      location.reload()
                      $('#login-modal').hide()


                    }
                    else{
                   alert('Please enter a valid creadential')
                     
                    }
                })
                
                // logout 
                $('#user_logout').on('click',function(){
                  
                  sessionStorage.setItem('loggedIn',false)
                  location.reload()
                })
           
            $(document).ready(function(e){
              
              let demo = localStorage.getItem('user')
              console.log(demo)
              if (sessionStorage.getItem('loggedIn') == 'true'){
                $('#main_container').show()
                var user = localStorage.getItem('user')
                console.log(user)
                $('#username').text(user)
              $('#username_tag').attr('username')

              //  localStorage.clear()
              // post 
              $('#post_btn').on('click',function(){
              var post = $('#post_input').val()
              var user_data =JSON.parse(localStorage.getItem(user))
              if(user_data.post){
                var date = `${new Date().toLocaleTimeString()} ${new Date().toISOString().split('T')[0]}`
                console.log(date)
                user_data.post.push( {'post':post,'post_time':date})
                localStorage.setItem(user,JSON.stringify(user_data))
                user_ = localStorage.getItem(user)
             
              }else{
                var user_post = {'post':post,'post_time':new Date().toLocaleTimeString()}
                user_data['post'] = [user_post]
                localStorage.setItem(user,JSON.stringify(user_data))
              }
              
              location.reload()
              })
            

             
              //   profile showing 
              $('#update_profile').on('click',function(){
              
                   var profile_name = $('#profile_name_input').val()
                   var profile_bio = $('#profile_bio').val()
                   var user_profile = JSON.stringify({'profile_name':profile_name,'bio':profile_bio})
                   localStorage.setItem(user,user_profile)
                   location.reload()
                   
                })
                // profile view
                var profile = localStorage.getItem(user)
                var profile_details = JSON.parse(profile)
                $('#profile_name').text(profile_details.profile_name)
                $('#bio').text(profile_details.bio)
               
               
              //  post showing
          
              var user_post =JSON.parse(localStorage.getItem(user))
              console.log(user_post)
              if (user_post){
               console.log('user_post')
               if (user_post.post.length){
                console.log('user_post_post')
                var user_post_length = user_post.post.length
    
                for(i=0; i< user_post_length; i++){
                
                  var col = $( `<div class=" shadow  rounded p-3 mt-2" style="background-color: rgb(171, 173, 218);" >`)
                  var h5 = $( ` <h5 class="">${user_post.profile_name}</h5>`)
                  var edit = $(`<div class="d-flex justify-content-end "><button class=" btn btn-edit-post " data-bs-toggle="modal" data-bs-target="#post_update" >&hellip;</button></div>`)
                  var p = $(`<p class=" mx-3 d-flex justify-content-right position-absolute mt-4" >${user_post.post[i].post}</p>`)
                  var p_two= $(`<p class="d-flex justify-content-end mt-5" >${user_post.post[i].post_time}  </p>`)
                  var btn = $(`<button class="btn btn-primary  " id="post_comment_btn">Comment</button>`)
                  var comment_div = $(`<div class="shadow  p-4 mb-3 div_comment" style="background-color: rgb(210, 212, 241);">Comments <p></p></div>`)
                  var div_form = $(`<div class="form-group d-flex justify-content-between"><input type="text" id="post_comment" class="form-control"></div>`)
                  div_form.append(btn)
                  col.append(edit)
                  col.append(h5)
                  col.append(p)
                  col.append(p_two)
                  col.append(comment_div)
                  col.append(div_form)
                  $('.all-post').append(col)  

                  // add comment 
                     btn.on('click',function(){
                      const comment_value = $(this).parent().find('input').val()
                      var tag = $(this).siblings().hide()
                      var p = $(`<p class="mt-3 mx-3">${comment_value}</p>`)
                      .append(p)
                      })
                    // edit post 
                    edit.on('click',function(){
                      var post = $(this).parent().find('p').eq(0).html()
                      var post_time = $(this).parent().find('p').eq(1).html()
                      $('#post_update_value').val(post)

     
                      $('#update-post').on('click',function(){
                          var post_update_value = $('#post_update_value').val()
                          const length_post = user_post.post.length
                          for (i=0; i<length_post; i++){  
                            if (user_post.post[i].post == post ){

                              const updated_date = `${new Date().toLocaleTimeString()} ${new Date().toISOString().split('T')[0]}`
                              user_post.post[i]['post'] = `${post_update_value}   --(edited)`
                              user_post.post[i]['post_time'] = updated_date
                              localStorage.setItem(user,JSON.stringify(user_post))       
                              location.reload()
                            }
                          }
                        })

                      $('#delete-post').on('click',function(){
                          const length_post = user_post.post.length
                          for (i=0; i<length_post; i++){  
                            if (user_post.post[i].post == post ){
                              var demo = user_post.post[i]
                            
                              user_post.post.splice(i)
                              localStorage.setItem(user,JSON.stringify(user_post))       
                              location.reload()
                            }
                          }
                      })
                     



                    
                      
                    })

                }
              }
            }      
          }else{
            $('#user_form').click()
        }
        })
        </script> 
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
   </body>
</html>